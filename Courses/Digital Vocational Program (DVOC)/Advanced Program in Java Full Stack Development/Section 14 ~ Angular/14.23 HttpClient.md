## What is HttpClient?

![[HttpClient (Part 1).jpg]]

## Features of HttpClient

![[HttpClient (Part 2).jpg]]

## HttpClient Setup

### How to create a new project

Type the following command:

```CMD
ng new crud-angular-app
```

### How to setup `app`?

Add the following code to `app.component.ts`:

```TS
import { Component, OnInit } from '@angular/core';
import { EmpService } from './services/emp.service';
import { Router } from '@angular/router';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})

export class AppComponent{
  title = 'crud-angular-app';
  
  constructor(private router: Router) { }

  createEmployee() {
    this.router.navigateByUrl("/create");
  }
}
```

Add the following code to `app.component.html`:

```HTML
<h1>CRUD in Angular</h1>
<hr />
<nav>
  <a routerLink="/create">Create</a>
  <a routerLink="/view">View</a>
</nav>
<hr />
<router-outlet></router-outlet>
```

Add the following code to `app-routing.module.ts` to setup routes:

```TS
import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { CreateComponent } from './create/create.component';
import { ViewComponent } from './view/view.component';
import { UpdateComponent } from './update/update.component';

const routes: Routes = [
  {path: "create", component: CreateComponent},
  {path: "view", component: ViewComponent},
  {path: "update/:id", component: UpdateComponent}
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})

export class AppRoutingModule { }
```

### How to install the JSON server?

Type the following command to install JSON server:

```CMD
npm install -g json-server
```

Create a `data` folder inside `crud-angular-app\src\assets`.

Create a new file and name it `employee.json`.

Add the following code to `employee.json`.

```JSON
{
    "employees": [
        {
            "id": 1,
            "firstname": "Vishal",
            "lastname": "Kushwaha",
            "designation": "Manager",
            "salary": 35000
        },
        {
            "id": 2,
            "firstname": "Meena",
            "lastname": "Devi",
            "designation": "Supervisor",
            "salary": 45000
        },
        {
            "id": 3,
            "firstname": "Shriram",
            "lastname": "Kushwaha",
            "designation": "Sales Executive",
            "salary": 25000
        },
        {
            "id": 4,
            "firstname": "Shweta",
            "lastname": "Kumari",
            "designation": "Sales Executive",
            "salary": 15000
        },
        {
            "id": 5,
            "firstname": "Rain",
            "lastname": "Spring",
            "designation": "Sales Executive",
            "salary": 15000
        }
    ]
}
```

Right click on `employee.json` and select “Open in Integrated Terminal”.

Now type the following command to deploy the JSON server:

```CMD
json-server employee.json
```

### How to import HttpClient?

Go to file `app.module.ts` and add `HttpClientModule` in imports array from package `@angular/common/http`.

```TS
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { AppRoutingModule } from './app-routing.module';
import { AppComponent } from './app.component';
import {HttpClientModule} from '@angular/common/http';
import { CreateComponent } from './create/create.component';
import { ViewComponent } from './view/view.component'
import { FormsModule } from '@angular/forms';
import { UpdateComponent } from './update/update.component';

@NgModule({
  declarations: [
    AppComponent,
    CreateComponent,
    ViewComponent,
    UpdateComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule,
    HttpClientModule,
    FormsModule
  ],
  providers: [],
  bootstrap: [AppComponent]
})

export class AppModule { }
```

### How to create a service?

Type the following command to create a service:

```CMD
ng g service emp
```

Add the following code to `emp.service.ts`:

```TS
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root'
})

export class EmpService {
  constructor(private myHttpData: HttpClient) { }

  url: string = "http://localhost:3000/employees";

  getEmployees() {
    return this.myHttpData.get(this.url);
  }

  getEmployeeById(id: any) {
    return this.myHttpData.get(this.url + "/" + id);  
  }

  saveEmployee(empData: any) {
    return this.myHttpData.post(this.url, empData);
  }

  deleteEmployee(id: any) {
    return this.myHttpData.delete(this.url + "/" + id);
  }

  updateEmployee(id: any, body: any) {
    return this.myHttpData.put(this.url + "/" + id, body);
  }
}
```

### How to retrieve, update, and delete data?

Now retrieve data in `view.component.ts` using `EmpService` as below:

```Ts
import { Component, OnInit } from '@angular/core';
import { EmpService } from '../services/emp.service';
import { Router } from '@angular/router';

@Component({
  selector: 'app-view',
  templateUrl: './view.component.html',
  styleUrls: ['./view.component.css']
})

export class ViewComponent implements OnInit {
  constructor(private emp:EmpService, private updateRoute: Router) {}

  employees: any;

  getEmployeeData() {
    this.emp.getEmployees().subscribe((data) => {
      this.employees = data;
      console.log(data);
    })
  }

  deleteEmp(id: any) {
    this.emp.deleteEmployee(id).subscribe(data => {
      alert("Data Deleted Successfully!");
    })
  }

  editEmp(id: any) {
    this.updateRoute.navigateByUrl("/update/" + id);
  }

  ngOnInit(): void {
    this.getEmployeeData();
  }
}
```

To display data in tabular form, type the following code in `view.component.html`:

```HTML
<h2>View Employees</h2>
<div>
  <table>
      <tr style="font-weight: bold;">
        <td>ID</td>
        <td>First Name</td>
        <td>Last Name</td>
        <td>Designation</td>
        <td>Salary</td>
      </tr>
      <tr *ngFor = "let e of employees">
        <td>{{e.id}}</td>
        <td>{{e.firstname}}</td>
        <td>{{e.lastname}}</td>
        <td>{{e.designation}}</td>
        <td>{{e.salary}}</td>
        <td><button (click)="deleteEmp(e.id)">Delete</button></td>
        <td><button (click)="editEmp(e.id)">Edit</button></td>
      </tr>
    </table>  
</div>
```

#### How to update data?

Add the following code to `update.component.ts`:

```TS
import { Component, OnInit } from '@angular/core';
import { EmpService } from '../services/emp.service';
import { ActivatedRoute } from '@angular/router';
import { NgForm } from '@angular/forms';

@Component({
  selector: 'app-update',
  templateUrl: './update.component.html',
  styleUrls: ['./update.component.css']
})

export class UpdateComponent implements OnInit{
  // Activated Route is the current route i.e. localhost:4200/update/3
  constructor(private emps: EmpService, private myRoute: ActivatedRoute) {}
  
  empData: any;
  empId: any;

  ngOnInit(): void {
    this.myRoute.paramMap.subscribe((queryString) => {
      this.empId = queryString.get('id');
    });

    this.emps.getEmployeeById(this.empId).subscribe((data) => {
      this.empData = data;
    });
  }

  editEmp(updateData: NgForm) {
    this.emps.updateEmployee(this.empId, updateData.value).subscribe((data) => {
      alert("Employee update successfully!");
    });
  }
}
```

Add the following code to `update.component.html`:

```HTML
<h2>Update Employee</h2>
<div>
    <form #updateForm="ngForm" (ngSubmit)="editEmp(updateForm)">
        <table>
            <tr>
                <td>ID: </td>
                <td><input type="text" name="id" id="id" [(ngModel)] = "empData.id"/></td>
            </tr>
            <tr>
                <td>First Name: </td>
                <td><input type="text" name="firstname" id="fname" [(ngModel)] = "empData.firstname"/></td>
            </tr>
            <tr>
                <td>Last Name: </td>
                <td><input type="text" name="lastname" id="lastname" [(ngModel)] = "empData.lastname"/></td>
            </tr>
            <tr>
                <td>Designation: </td>
                <td><input type="text" name="designation" id="designation" [(ngModel)] = "empData.designation"/></td>
            </tr>
            <tr>
                <td>Salary</td>
                <td><input type="text" name="salary" id="salary" [(ngModel)] = "empData.salary"/></td>
            </tr>        
            <tr>
                <td><button type="submit">Save</button></td>
                <td></td>
            </tr>
        </table>        
    </form>
</div>
```

### How to create new data?

Add the following code to  `create.component.ts`:

```TS
import { Component, OnInit } from '@angular/core';
import { NgForm } from '@angular/forms';
import { EmpService } from '../services/emp.service';

@Component({
  selector: 'app-create',
  templateUrl: './create.component.html',
  styleUrls: ['./create.component.css']
})

export class CreateComponent{
  constructor(private emps: EmpService) {}

  empNewData: any;
  
  saveFormData(empFormData: NgForm) {
    this.emps.saveEmployee(empFormData.value).subscribe(data => {
      this.empNewData = data;
      console.log(this.empNewData);
      alert("Data Saved Successfully");
    })
  }
}
```

Add the following code to `create.component.html`:

```HTML
<h2>Create Employee</h2>
<div>
    <form #empForm="ngForm" (ngSubmit)="saveFormData(empForm)">
        <table>
            <tr>
                <td>ID: </td>
                <td><input type="text" name="id" id="id" #id="ngModel" ngModel/></td>
            </tr>
            <tr>
                <td>First Name: </td>
                <td><input type="text" name="firstname" id="fname" #firstname="ngModel" ngModel/></td>
            </tr>
            <tr>
                <td>Last Name: </td>
                <td><input type="text" name="lastname" id="lastname" #lastname="ngModel" ngModel/></td>
            </tr>
            <tr>
                <td>Designation: </td>
                <td><input type="text" name="designation" id="designation" #designation="ngModel" ngModel/></td>
            </tr>
            <tr>
                <td>Salary</td>
                <td><input type="text" name="salary" id="salary" #salary="ngModel" ngModel/></td>
            </tr>        
            <tr>
                <td><button type="submit">Save</button></td>
                <td></td>
            </tr>
        </table>        
    </form>
</div>
```